---
title: "Diet Compositions and Obesity"
author: "Ken Ye"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
```

```{r}
# Load libraries
library(knitr)
library(kableExtra)
library(dplyr)
library(betareg)
```

```{r}
# Load data set
supply_kcal_data <- read.csv("Data/Food_Supply_kcal_Data.csv")
data_dic <- read.csv("Data/Supply_Food_Data_Descriptions.csv")
```

# Introduction

\newpage

# Data

```{r}
kable(data_dic) |>
  column_spec(column = 1, width = "11em")|> 
  column_spec(column = 2, width = "37em")
```

| Categories | Items                    |
|------------|--------------------------|
| Grain      | Cereals - Excluding Beer |
| Vegetable  | Aquatic Products, Other  |
|            | Vegetables               |
|            | Starchy Roots            |
|            | Vegetal Products         |
| Fruit      | Fruits - Excluding Wine  |
| Protein    | Animal Products          |
|            | Eggs                     |
|            | Fish, Seafood            |
|            | Meat                     |
|            | Offals                   |
|            | Oilcrops                 |
|            | Pulses                   |
|            | Treenuts                 |
| Other      | Alcoholic Beverages      |
|            | Animal fats              |
|            | Milk - Excluding Butter  |
|            | Miscellaneous            |
|            | Spices                   |
|            | Stimulants               |
|            | Sugar & Sweeteners       |
|            | Sugar Crops              |
|            | Vegetable Oils           |

```{r}
# Define the mapping of categories to groups
category_mapping <- list(
  Grain = c("Cereals...Excluding.Beer"),
  Vegetable = c("Aquatic.Products..Other", "Vegetables", "Starchy.Roots", "Vegetal.Products"),
  Fruit = c("Fruits...Excluding.Wine"),
  Protein = c("Animal.Products", "Eggs", "Fish..Seafood", "Meat", "Offals", "Oilcrops", "Pulses", "Treenuts"),
  Other = c("Alcoholic.Beverages", "Animal.fats", "Milk...Excluding.Butter", "Miscellaneous", "Spices", "Stimulants", "Sugar.Crops", "Sugar...Sweeteners", "Vegetable.Oils")
)

# Use mutate to create new columns for each group
supply_kcal_data <- supply_kcal_data %>%
  mutate(
    Grain = rowSums(select(supply_kcal_data, category_mapping$Grain)),
    Vegetable = rowSums(select(supply_kcal_data, category_mapping$Vegetable)),
    Fruit = rowSums(select(supply_kcal_data, category_mapping$Fruit)),
    Protein = rowSums(select(supply_kcal_data, category_mapping$Protein)),
    Other = rowSums(select(supply_kcal_data, category_mapping$Other))
  )
```

```{r}
# Create obesity dataframe
selected_columns <- c("Country", "Grain", "Vegetable", "Fruit", "Protein", "Other", "Obesity")
obesity_data <- supply_kcal_data[, selected_columns]
obesity_data <- na.omit(obesity_data)

# Make Obesity a proportion between 0 and 1
obesity_data$Obesity <- obesity_data$Obesity / 100

# Order the data frame based on the 'Obesity' column
obesity_data <- obesity_data[order(obesity_data$Obesity), ]

# Reset row names
rownames(obesity_data) <- NULL

kable(head(obesity_data))
```

\newpage

# Methodology

```{r}
# Fit Beta regression model
beta_model <- betareg(Obesity ~ Grain + Vegetable + Fruit + Protein, data = obesity_data)

# Summary of the model
summary(beta_model)
```

\newpage

# Results

\newpage

# Conclusion
